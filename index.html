<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gravity Flip - Free HTML5 Game</title>
<meta name="description" content="Play Gravity Flip - Tap to flip gravity up/down while dodging obstacles from both sides. Collect stars for bonus points. Obstacles speed up gradually.">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#0a0a1a">
<meta property="og:type" content="website">
<meta property="og:title" content="Gravity Flip - Free HTML5 Game">
<meta property="og:description" content="Tap to flip gravity up/down while dodging obstacles from both sides. Collect stars for bonus points!">
<meta property="og:url" content="https://balinti.github.io/gravity-flip/">
<meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='600' height='315'%3E%3Crect fill='%230a0a1a' width='600' height='315'/%3E%3Ctext x='300' y='160' text-anchor='middle' fill='white' font-size='40'%3EGravity Flip%3C/text%3E%3C/svg%3E">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Gravity Flip - Free HTML5 Game">
<meta name="twitter:description" content="Tap to flip gravity up/down while dodging obstacles from both sides. Collect stars for bonus points!">
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"VideoGame",
  "name":"Gravity Flip",
  "description":"Tap to flip gravity up/down while dodging obstacles from both sides. Collect stars for bonus points. Obstacles speed up gradually.",
  "genre":"Hyper-casual",
  "gamePlatform":"Web Browser",
  "applicationCategory":"Game",
  "operatingSystem":"Any",
  "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
  "url":"https://balinti.github.io/gravity-flip/"
}
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4099346100621490" crossorigin="anonymous"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#050510;font-family:'Segoe UI',system-ui,-apple-system,sans-serif;touch-action:none;user-select:none;-webkit-user-select:none}
#wrap{display:flex;align-items:center;justify-content:center;width:100%;height:100vh;flex-direction:column}
#frame{position:relative;width:100%;max-width:420px;max-height:750px;aspect-ratio:420/750;overflow:hidden;border-radius:8px;box-shadow:0 0 40px rgba(100,60,255,.15)}
canvas{display:block;width:100%;height:100%}
#about{max-width:420px;width:100%;padding:12px 16px;margin-top:8px;color:#888;font-size:12px;line-height:1.5;text-align:center}
#about summary{cursor:pointer;color:#aaa;font-size:13px;outline:none}
#about p{margin-top:6px;color:#777}
</style>
</head>
<body>
<div id="wrap">
  <div id="frame"><canvas id="c"></canvas></div>
  <details id="about">
    <summary>About / How to Play</summary>
    <p><strong>Gravity Flip</strong> is a hyper-casual HTML5 game. Tap or press Space/Enter to flip gravity and switch your polarity. Your orb is either white or black &mdash; pass through gates of the <em>opposite</em> color to survive. If your color matches the gate, you die! Dodge spikes, collect Combo Sparks for bonus points and score multipliers, and see how far you can go as the speed ramps up. Works on desktop and mobile.</p>
  </details>
</div>
<script>
(function(){
"use strict";

const cvs=document.getElementById('c');
const ctx=cvs.getContext('2d');
const frame=document.getElementById('frame');
const DPR=Math.min(window.devicePixelRatio||1,3);
let W=420,H=750;

function resize(){
  const fr=frame.getBoundingClientRect();
  W=fr.width;H=fr.height;
  cvs.style.width=W+'px';
  cvs.style.height=H+'px';
  cvs.width=Math.round(W*DPR);
  cvs.height=Math.round(H*DPR);
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
window.addEventListener('resize',resize);
resize();

const RAIL_TOP=50;
const RAIL_BOT_OFF=50;
const PX=80;
const PR=12;
const SPIKE_W=28,SPIKE_H=32;
const GATE_W=18;
const SPARK_R=9;
const BASE_SPEED=160;
const MAX_SPEED=420;
const SPEED_RAMP=0.45;
const SPRING_K=16;
const SPRING_DAMP=8;
const MAX_PARTS=200;
const SLOWMO_SCALE=0.70;
const SLOWMO_DUR=0.7;
const DEATH_FREEZE_DUR=0.1;

let state='start';
let score=0,best=parseInt(localStorage.getItem('gf_best'))||0;
let multiplier=1,conSparks=0,distAcc=0,difficulty=0;
let timeScale=1,slowmoTimer=0,freezeTimer=0;
let deathCause='';
let shakeX=0,shakeY=0,shakeMag=0,shakeTimer=0,shakeDur=0;
let hueShift=0,gameTime=0;

let py=0,pvy=0,pgrav=1,ppol=0;

function rBot(){return H-RAIL_BOT_OFF;}
function targY(){return pgrav===1?rBot()-PR:RAIL_TOP+PR;}

function resetPlayer(){pgrav=1;ppol=0;py=targY();pvy=0;}

let obs=[],sparks=[],telegraphs=[],particles=[];
let spawnX=0;

function gSpeed(){return Math.min(BASE_SPEED+difficulty*SPEED_RAMP,MAX_SPEED);}

function spawnChunk(){
  const speed=gSpeed();
  const minGap=Math.max(70,130-difficulty*0.25);
  const chunkPx=(2+Math.random()*2.5)*speed;
  const df=Math.min(difficulty/250,1);
  let cx=0;

  while(cx<chunkPx){
    const roll=Math.random();
    const ox=spawnX+cx;

    if(roll<0.32){
      const side=Math.random()<0.5?'f':'c';
      const oy=side==='f'?rBot():RAIL_TOP;
      obs.push({t:'s',x:ox,y:oy,s:side,w:SPIKE_W,h:SPIKE_H});
      addTele(ox,oy,side);
      cx+=minGap+Math.random()*40;
    }else if(roll<0.32+0.35*(0.4+0.6*df)){
      const gp=Math.random()<0.5?0:1;
      const side=Math.random()<0.5?'f':'c';
      const oy=side==='f'?rBot():RAIL_TOP;
      const gh=48+Math.random()*32;
      obs.push({t:'g',x:ox,y:oy,s:side,p:gp,w:GATE_W,h:gh});
      addTele(ox,oy,side);
      cx+=minGap+25+Math.random()*30;
    }else{
      const sy=RAIL_TOP+40+Math.random()*(rBot()-RAIL_TOP-80);
      sparks.push({x:ox,y:sy,r:SPARK_R,a:true});
      cx+=minGap*0.55;
    }

    if(df>0.35&&Math.random()<df*0.28){
      const s2=Math.random()<0.5?'f':'c';
      const ox2=spawnX+cx;
      const oy2=s2==='f'?rBot():RAIL_TOP;
      obs.push({t:'s',x:ox2,y:oy2,s:s2,w:SPIKE_W,h:SPIKE_H});
      addTele(ox2,oy2,s2);
      cx+=minGap*0.45;
    }
  }
  spawnX+=chunkPx;
}

function addTele(x,y,side){
  telegraphs.push({x:x,y:y,s:side,a:0.12});
}

function emit(x,y,n,hue,spd){
  for(let i=0;i<n&&particles.length<MAX_PARTS;i++){
    const a=Math.random()*Math.PI*2;
    const v=(0.5+Math.random())*spd;
    particles.push({x:x,y:y,vx:Math.cos(a)*v,vy:Math.sin(a)*v,
      life:0.35+Math.random()*0.5,ml:0.35+Math.random()*0.5,
      r:2+Math.random()*3,hue:hue+Math.random()*40-20});
  }
}

function shake(mag,dur){shakeMag=mag;shakeDur=dur;shakeTimer=dur;}

function handleInput(){
  if(state==='start'){startGame();}
  else if(state==='playing'){flip();}
  else if(state==='gameover'&&freezeTimer<=0){state='start';}
}

document.addEventListener('pointerdown',function(e){e.preventDefault();handleInput();});
document.addEventListener('keydown',function(e){
  if(e.code==='Space'||e.code==='Enter'){e.preventDefault();handleInput();}
});

function flip(){
  pgrav*=-1;
  ppol=ppol===0?1:0;
  emit(PX,py,8,ppol===0?60:260,80);
  shake(2,0.1);
}

function startGame(){
  state='playing';score=0;multiplier=1;conSparks=0;distAcc=0;difficulty=0;
  timeScale=1;slowmoTimer=0;freezeTimer=0;gameTime=0;
  obs=[];sparks=[];telegraphs=[];particles=[];deathCause='';
  resetPlayer();
  spawnX=W+100;
  spawnChunk();spawnChunk();
}

function die(cause){
  state='gameover';deathCause=cause;freezeTimer=DEATH_FREEZE_DUR;
  if(score>best){best=score;localStorage.setItem('gf_best',best);}
  emit(PX,py,45,ppol===0?0:270,220);
  shake(14,0.45);
}

function circRect(cx,cy,cr,rx,ry,rw,rh){
  const nx=Math.max(rx,Math.min(cx,rx+rw));
  const ny=Math.max(ry,Math.min(cy,ry+rh));
  const dx=cx-nx,dy=cy-ny;
  return dx*dx+dy*dy<cr*cr;
}

function checkColl(){
  for(let i=obs.length-1;i>=0;i--){
    const o=obs[i];
    if(o.x+o.w<PX-PR-20||o.x>PX+PR+20)continue;
    if(o.t==='s'){
      let sx=o.x-o.w/2,sy=o.s==='f'?o.y-o.h:o.y;
      if(circRect(PX,py,PR,sx,sy,o.w,o.h)){die('Spiked!');return;}
    }else if(o.t==='g'){
      let gx=o.x-o.w/2,gy=o.s==='f'?o.y-o.h:o.y;
      if(circRect(PX,py,PR,gx,gy,o.w,o.h)){
        if(ppol===o.p){die('Wrong polarity!');return;}
      }
    }
  }
  for(let i=sparks.length-1;i>=0;i--){
    const s=sparks[i];
    if(!s.a)continue;
    const dx=PX-s.x,dy=py-s.y;
    if(dx*dx+dy*dy<(PR+s.r)*(PR+s.r)){
      s.a=false;conSparks++;
      multiplier=Math.min(8,1+Math.floor(conSparks/2));
      score+=10*multiplier;
      slowmoTimer=SLOWMO_DUR;timeScale=SLOWMO_SCALE;
      emit(s.x,s.y,16,50,130);
      shake(3,0.12);
    }
  }
  if(py-PR<RAIL_TOP){py=RAIL_TOP+PR;pvy=0;}
  if(py+PR>rBot()){py=rBot()-PR;pvy=0;}
}

let lastT=0;
function loop(ts){
  requestAnimationFrame(loop);
  if(!lastT){lastT=ts;return;}
  let rawDt=(ts-lastT)/1000;
  lastT=ts;
  rawDt=Math.min(rawDt,1/30);
  hueShift+=rawDt*22;

  if(freezeTimer>0){
    freezeTimer-=rawDt;
    updParts(rawDt);updShake(rawDt);
    draw();return;
  }

  if(slowmoTimer>0){slowmoTimer-=rawDt;if(slowmoTimer<=0)timeScale=1;}
  const dt=rawDt*timeScale;

  if(state==='playing'){
    gameTime+=dt;difficulty+=dt;
    const speed=gSpeed();
    distAcc+=speed*dt;
    while(distAcc>=40){distAcc-=40;score+=1;}

    const ty=targY();
    const disp=ty-py;
    const springF=disp*SPRING_K;
    pvy+=springF*dt*60;
    pvy*=Math.max(0,1-SPRING_DAMP*dt*60);
    py+=pvy*dt*60;

    for(let i=0;i<obs.length;i++)obs[i].x-=speed*dt;
    for(let i=0;i<sparks.length;i++)sparks[i].x-=speed*dt;
    for(let i=0;i<telegraphs.length;i++)telegraphs[i].x-=speed*dt;

    obs=obs.filter(o=>o.x>-60);
    sparks=sparks.filter(s=>s.x>-30&&s.a);
    telegraphs=telegraphs.filter(t=>t.x>-60);

    let furthest=0;
    for(let i=0;i<obs.length;i++)if(obs[i].x>furthest)furthest=obs[i].x;
    if(furthest<W+300)spawnChunk();

    checkColl();
  }

  updParts(rawDt);updShake(rawDt);
  draw();
}

function updParts(dt){
  for(let i=particles.length-1;i>=0;i--){
    const p=particles[i];
    p.x+=p.vx*dt;p.y+=p.vy*dt;
    p.vx*=(1-3*dt);p.vy*=(1-3*dt);
    p.vy+=50*dt;p.life-=dt;
    if(p.life<=0)particles.splice(i,1);
  }
}

function updShake(dt){
  if(shakeTimer>0){
    shakeTimer-=dt;
    const e=Math.max(0,shakeTimer/shakeDur);
    shakeX=(Math.random()-0.5)*2*shakeMag*e;
    shakeY=(Math.random()-0.5)*2*shakeMag*e;
  }else{shakeX=0;shakeY=0;}
}

function draw(){
  ctx.save();
  ctx.translate(shakeX,shakeY);

  const bg=ctx.createLinearGradient(0,0,0,H);
  bg.addColorStop(0,'#0a0a1a');
  bg.addColorStop(0.5,'#0d0d2b');
  bg.addColorStop(1,'#0a0a1a');
  ctx.fillStyle=bg;
  ctx.fillRect(-20,-20,W+40,H+40);

  const rh=(hueShift%360)|0;
  ctx.fillStyle=`hsla(${rh},60%,30%,0.25)`;
  ctx.fillRect(0,0,W,RAIL_TOP);
  ctx.fillRect(0,rBot(),W,H-rBot());
  ctx.strokeStyle=`hsla(${rh},70%,50%,0.45)`;
  ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(0,RAIL_TOP);ctx.lineTo(W,RAIL_TOP);ctx.stroke();
  ctx.beginPath();ctx.moveTo(0,rBot());ctx.lineTo(W,rBot());ctx.stroke();

  if(state==='playing'||state==='gameover'){
    drawTele();drawObs();drawSparks();drawPlayer();drawParts();drawUI();
  }
  if(state==='start')drawStart();
  if(state==='gameover')drawGO();
  ctx.restore();
}

function drawTele(){
  for(const t of telegraphs){
    if(t.x<-40||t.x>W+100)continue;
    ctx.save();ctx.globalAlpha=t.a;
    ctx.fillStyle='#ff4466';
    for(let i=0;i<3;i++){
      const sx=t.x-9+i*12;
      if(t.s==='f')ctx.fillRect(sx,rBot()-38,6,38);
      else ctx.fillRect(sx,RAIL_TOP,6,38);
    }
    ctx.restore();
  }
}

function drawObs(){
  for(const o of obs){
    if(o.x<-60||o.x>W+60)continue;
    if(o.t==='s'){
      ctx.fillStyle=`hsl(${((hueShift+180)%360)|0},80%,55%)`;
      ctx.beginPath();
      if(o.s==='f'){
        ctx.moveTo(o.x,o.y-o.h);
        ctx.lineTo(o.x-o.w/2,o.y);
        ctx.lineTo(o.x+o.w/2,o.y);
      }else{
        ctx.moveTo(o.x,o.y+o.h);
        ctx.lineTo(o.x-o.w/2,o.y);
        ctx.lineTo(o.x+o.w/2,o.y);
      }
      ctx.closePath();ctx.fill();
      ctx.save();ctx.shadowColor=`hsl(${((hueShift+180)%360)|0},90%,60%)`;
      ctx.shadowBlur=8;ctx.fill();ctx.restore();
    }else if(o.t==='g'){
      const isW=o.p===0;
      ctx.fillStyle=isW?'rgba(255,255,255,0.92)':'rgba(20,20,35,0.95)';
      ctx.strokeStyle=isW?'rgba(255,255,255,0.8)':'rgba(100,70,200,0.7)';
      ctx.lineWidth=2;
      const gx=o.x-o.w/2;
      const gy=o.s==='f'?o.y-o.h:o.y;
      ctx.fillRect(gx,gy,o.w,o.h);
      ctx.strokeRect(gx,gy,o.w,o.h);
      ctx.fillStyle=isW?'#111':'#eee';
      ctx.font='bold 10px sans-serif';
      ctx.textAlign='center';ctx.textBaseline='middle';
      ctx.fillText(isW?'W':'B',o.x,gy+o.h/2);
      ctx.save();
      ctx.shadowColor=isW?'rgba(255,255,255,0.35)':'rgba(100,50,255,0.4)';
      ctx.shadowBlur=10;ctx.strokeRect(gx,gy,o.w,o.h);
      ctx.restore();
    }
  }
  ctx.textBaseline='alphabetic';
}

function drawSparks(){
  for(const s of sparks){
    if(!s.a||s.x<-20||s.x>W+20)continue;
    const pulse=1+0.15*Math.sin(gameTime*8);
    const r=s.r*pulse;
    ctx.beginPath();ctx.arc(s.x,s.y,r+4,0,Math.PI*2);
    ctx.fillStyle=`hsla(${((hueShift+50)%360)|0},100%,70%,0.22)`;ctx.fill();
    ctx.beginPath();
    for(let i=0;i<5;i++){
      const a=-Math.PI/2+(i*2*Math.PI/5);
      const ai=a+Math.PI/5;
      ctx.lineTo(s.x+Math.cos(a)*r,s.y+Math.sin(a)*r);
      ctx.lineTo(s.x+Math.cos(ai)*r*0.45,s.y+Math.sin(ai)*r*0.45);
    }
    ctx.closePath();
    ctx.fillStyle=`hsl(${((hueShift+50)%360)|0},100%,75%)`;
    ctx.fill();
    ctx.save();ctx.shadowColor=`hsl(${((hueShift+50)%360)|0},100%,80%)`;
    ctx.shadowBlur=12;ctx.fill();ctx.restore();
  }
}

function drawPlayer(){
  ctx.beginPath();ctx.arc(PX-6,py,PR*0.7,0,Math.PI*2);
  ctx.fillStyle=ppol===0?'rgba(255,255,255,0.08)':'rgba(80,50,180,0.12)';
  ctx.fill();

  ctx.beginPath();ctx.arc(PX,py,PR+4,0,Math.PI*2);
  ctx.fillStyle=ppol===0?'rgba(255,255,255,0.12)':'rgba(100,60,255,0.18)';
  ctx.fill();

  ctx.beginPath();ctx.arc(PX,py,PR,0,Math.PI*2);
  ctx.save();
  if(ppol===0){ctx.fillStyle='#fff';ctx.shadowColor='#fff';}
  else{ctx.fillStyle='#1a1a2e';ctx.shadowColor='#6633ff';}
  ctx.shadowBlur=15;ctx.fill();ctx.restore();
  ctx.strokeStyle=ppol===0?'rgba(200,200,255,0.8)':'rgba(130,80,255,0.9)';
  ctx.lineWidth=2;ctx.stroke();

  ctx.beginPath();ctx.arc(PX,py,PR*0.35,0,Math.PI*2);
  ctx.fillStyle=ppol===0?'rgba(200,220,255,0.5)':'rgba(130,80,255,0.6)';
  ctx.fill();

  ctx.beginPath();
  const ay=py+pgrav*(PR+8);
  ctx.moveTo(PX-5,ay-pgrav*4);ctx.lineTo(PX,ay);ctx.lineTo(PX+5,ay-pgrav*4);
  ctx.strokeStyle=ppol===0?'rgba(255,255,255,0.45)':'rgba(130,80,255,0.45)';
  ctx.lineWidth=1.5;ctx.stroke();
}

function drawParts(){
  for(const p of particles){
    const al=Math.max(0,p.life/p.ml);
    ctx.beginPath();ctx.arc(p.x,p.y,p.r*al,0,Math.PI*2);
    ctx.fillStyle=`hsla(${p.hue|0},90%,65%,${al.toFixed(2)})`;
    ctx.fill();
  }
}

function drawUI(){
  ctx.fillStyle='rgba(255,255,255,0.9)';
  ctx.font='bold 28px "Segoe UI",system-ui,sans-serif';
  ctx.textAlign='left';
  ctx.fillText(score,16,36);
  if(multiplier>1){
    ctx.fillStyle=`hsl(${((hueShift+50)%360)|0},100%,70%)`;
    ctx.font='bold 16px "Segoe UI",system-ui,sans-serif';
    ctx.fillText('x'+multiplier,16,56);
  }
  if(slowmoTimer>0){
    ctx.fillStyle=`hsla(${((hueShift+50)%360)|0},100%,75%,${(0.5+0.5*Math.sin(gameTime*12)).toFixed(2)})`;
    ctx.font='bold 12px sans-serif';ctx.textAlign='right';
    ctx.fillText('SLOW',W-16,36);
  }
  ctx.textAlign='right';ctx.font='12px sans-serif';
  ctx.fillStyle='rgba(255,255,255,0.45)';
  ctx.fillText(ppol===0?'WHITE':'BLACK',W-16,56);
}

function drawStart(){
  ctx.fillStyle='#fff';
  ctx.font='bold 42px "Segoe UI",system-ui,sans-serif';
  ctx.textAlign='center';
  ctx.save();ctx.shadowColor='rgba(100,60,255,0.6)';ctx.shadowBlur=20;
  ctx.fillText('Gravity Flip',W/2,H*0.32);
  ctx.restore();
  ctx.fillStyle='rgba(255,255,255,0.45)';
  ctx.font='14px sans-serif';
  ctx.fillText('Polarity Runner',W/2,H*0.32+30);
  const pulse=0.55+0.45*Math.sin(Date.now()/400);
  ctx.fillStyle=`rgba(255,255,255,${pulse.toFixed(2)})`;
  ctx.font='18px "Segoe UI",system-ui,sans-serif';
  ctx.fillText('Tap to Start',W/2,H*0.55);
  ctx.fillStyle='rgba(255,255,255,0.3)';ctx.font='13px sans-serif';
  ctx.fillText('Tap / Space / Enter to flip gravity & polarity',W/2,H*0.63);
  ctx.fillText('Pass through gates of the OPPOSITE color',W/2,H*0.67);
  ctx.fillText('Collect sparks for bonus points',W/2,H*0.71);
  if(best>0){
    ctx.fillStyle='rgba(255,255,255,0.4)';ctx.font='15px sans-serif';
    ctx.fillText('Best: '+best,W/2,H*0.80);
  }
}

function drawGO(){
  ctx.fillStyle='rgba(0,0,0,0.55)';ctx.fillRect(0,0,W,H);
  ctx.fillStyle='#ff4466';
  ctx.font='bold 20px "Segoe UI",system-ui,sans-serif';
  ctx.textAlign='center';ctx.fillText(deathCause,W/2,H*0.30);
  ctx.fillStyle='#fff';
  ctx.font='bold 38px "Segoe UI",system-ui,sans-serif';
  ctx.save();ctx.shadowColor='rgba(255,50,80,0.5)';ctx.shadowBlur=15;
  ctx.fillText('Game Over',W/2,H*0.40);ctx.restore();
  ctx.fillStyle='rgba(255,255,255,0.5)';ctx.font='16px sans-serif';
  ctx.fillText('SCORE',W/2,H*0.45);
  ctx.fillStyle='rgba(255,255,255,0.9)';
  ctx.font='bold 48px "Segoe UI",system-ui,sans-serif';
  ctx.fillText(score,W/2,H*0.52);
  ctx.fillStyle=`hsl(${((hueShift+50)%360)|0},80%,65%)`;
  ctx.font='bold 24px "Segoe UI",system-ui,sans-serif';
  ctx.fillText('Best: '+best,W/2,H*0.60);
  if(multiplier>1){
    ctx.fillStyle='rgba(255,255,255,0.4)';ctx.font='14px sans-serif';
    ctx.fillText('Max Multiplier: x'+multiplier,W/2,H*0.65);
  }
  if(freezeTimer<=0){
    const p2=0.5+0.5*Math.sin(Date.now()/350);
    ctx.fillStyle=`rgba(255,255,255,${p2.toFixed(2)})`;
    ctx.font='18px "Segoe UI",system-ui,sans-serif';
    ctx.fillText('Tap to Retry',W/2,H*0.78);
  }
}

requestAnimationFrame(loop);
})();
</script>
</body>
</html>
